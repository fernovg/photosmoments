<ion-header>
  <ion-toolbar class="toolbar-header">
    <ion-buttons slot="end">
      <ion-button color="medium" (click)="cancel()"><i class="fa-solid fa-xmark"></i></ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <div class="hero">
    <h1>
      Edita tu evento
    </h1>
  </div>

  <div class="cover-selector">
    <div class="cover-header">
      <ion-label>Portada del evento</ion-label>
      <ion-button size="small" fill="outline" (click)="coverInput.click()">
        <i class="fa-solid fa-upload"></i>
        Subir
      </ion-button>
      <input #coverInput type="file" accept="image/*" (change)="onCoverSelected($event)" hidden>
    </div>
    <small class="hint">Formatos de imagen, máximo 5 MB.</small>
    <div class="cover-preview" *ngIf="coverPreview">
      <ion-img [src]="coverPreview" alt="Portada seleccionada"></ion-img>
    </div>
  </div>

  <form action="" [formGroup]="cEvento">
    <ion-list>

      <ion-item lines="none">
        <ion-input label="Nombre" label-placement="floating" type="text" formControlName="name"></ion-input>
      </ion-item>

      <ion-item lines="none" (click)="abrirFecha()">
        <ion-input label="Fecha" label-placement="stacked" type="text" formControlName="event_date" name="event_date"
          readonly placeholder="Ingresa la fecha del evento"
          [value]="fechaSeleccionada | date:'dd/MM/yyyy HH:mm'"></ion-input>
        <i class="fa-solid fa-calendar-days"></i>
      </ion-item>

      <ion-item lines="none">
        <ion-input label="Lugar" label-placement="stacked" type="text" formControlName="address" name="address"
          placeholder="Escribe el lugar del evento"></ion-input>
      </ion-item>

      <ion-item lines="none">
        <ion-toggle [enableOnOffLabels]="true" formControlName="can_view_photos_before_event"
          name="can_view_photos_before_event" helperText="Se pueden ver fotos antes del evento"
          errorText="No se podran ver las fotos antes del evento" (ionChange)="valVerFotos()">Ver fotos</ion-toggle>
      </ion-item>

      <ion-item lines="none">
        <ion-toggle [enableOnOffLabels]="true" formControlName="can_upload_photos_before_event"
          name="can_upload_photos_before_event" helperText="Se pueden subir fotos antes del evento"
          errorText="No se podran subir las fotos antes del evento" (ionChange)="valSubirFotos()">Subir
          fotos</ion-toggle>
      </ion-item>

      <ion-item lines="none">
        <ion-label position="stacked">Cantidad de invitados</ion-label>
        <div class="btn-group">
          <ion-button *ngFor="let g of invitados" size="small"
            fill="{{ cEvento.value.total_guests === g ? 'solid' : 'outline' }}" (click)="setInvitados(g)">
            {{ g }}
          </ion-button>

          <div class="btn-badge">
            <ion-button size="small" fill="{{ customInvitados ? 'solid' : 'outline' }}"
              (click)="setInvitados('custom')">+50</ion-button>
            <ion-badge>
              <i class="fa-solid fa-crown"></i>
            </ion-badge>
          </div>
        </div>
      </ion-item>

      <ion-item lines="none">
        <ion-label position="stacked">Cantidad de fotos por invitado</ion-label>
        <div class="btn-group">
          <ion-button *ngFor="let f of fotos" size="small"
            fill="{{ cEvento.value.max_photos_per_guest === f ? 'solid' : 'outline' }}" (click)="setFotos(f)">
            {{ f }}
          </ion-button>

          <div class="btn-badge">
            <ion-button size="small" fill="{{ customFotos ? 'solid' : 'outline' }}" (click)="setFotos('custom')"><i
                class="fa-solid fa-infinity"></i></ion-button>
            <ion-badge>
              <i class="fa-solid fa-crown"></i>
            </ion-badge>
          </div>
        </div>
      </ion-item>

      <ion-item lines="none">
        <ion-label position="stacked">Ver todas las fotos despues de:</ion-label>
        <div>
          <ion-button *ngFor="let d of dias" size="small"
            fill="{{ cEvento.value.days_before_upload === d ? 'solid' : 'outline' }}" (click)="setDias(d)">
            {{ d }} Dias</ion-button>

          <div class="btn-badge">
            <ion-button size="small" fill="{{ customDays ? 'solid' : 'outline' }}" (click)="setDias('custom')">
              30 Días
            </ion-button>

            <ion-badge>
              <i class="fa-solid fa-crown"></i>
            </ion-badge>
          </div>

        </div>
      </ion-item>

    </ion-list>
  </form>

  <ion-button expand="block" id="present-alert" color="danger">Eliminar Evento</ion-button>
  <ion-alert trigger="present-alert" header="Seguro que quieres elminar este evento?" [buttons]="alertButtons"
    (didDismiss)="setResult($event)"></ion-alert>
</ion-content>

<ion-footer>
  <ion-toolbar class="toolbar-footer">
    <ion-button size="block" (click)="confirm()">Guardar</ion-button>
  </ion-toolbar>
</ion-footer>